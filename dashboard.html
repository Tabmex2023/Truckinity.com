<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Truckinity ‚Äì Drivers United Dashboard">
<title>Truckinity Dashboard ‚Äì Drivers United</title>

<!-- Icons -->
<link rel="icon" type="image/png" sizes="32x32" href="assets/logo-32.png">
<link rel="apple-touch-icon" sizes="192x192" href="assets/logo-192.png">
<link rel="manifest" href="manifest.json">

<!-- Styles -->
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&display=swap" rel="stylesheet">

<style>
:root {
  --bg-main: #000000;
  --bg-secondary: #0f0f0f;
  --accent-blue: #1e90ff;
  --accent-orange: #ff7a00;
  --text-main: #ffffff;
  --text-muted: #999999;
}
body {
  margin:0; padding:0; font-family:'Poppins',sans-serif;
  background: var(--bg-main); color: var(--text-main);
}
header { display:flex; justify-content:space-between; align-items:center; padding:20px 30px; background:#000; border-bottom:1px solid #111; position:sticky; top:0; z-index:1000;}
.logo {height:80px;}
.language-dropdown {position:relative; cursor:pointer;}
.lang-menu {display:none; position:absolute; top:100%; right:0; background:#111; border:1px solid #333; border-radius:5px; overflow:hidden;}
.lang-menu div {padding:8px 15px; color:#fff;}
.lang-menu div:hover {background: linear-gradient(90deg, var(--accent-blue), var(--accent-orange));}
.header-right {display:flex; gap:15px; align-items:center;}
button {padding:8px 16px; border-radius:5px; border:none; cursor:pointer;}
button:hover {opacity:0.8;}
.tabs {display:flex; gap:10px; margin:20px; flex-wrap:wrap;}
.tabs button {background: var(--bg-secondary); color:#fff; border:1px solid #111; font-weight:600;}
.tabs button.active {background: linear-gradient(90deg, var(--accent-blue), var(--accent-orange)); color:#fff;}
.tab-content {padding:10px; margin:0 20px;}
#map {height:500px; border-radius:10px; border:1px solid #111;}
.modal {display:none; position:fixed; z-index:2000; left:0; top:0; width:100%; height:100%; overflow:auto; background-color: rgba(0,0,0,0.8);}
.modal-content {background:#111; margin:10% auto; padding:20px; border-radius:10px; width:90%; max-width:400px; color:#fff;}
.close-btn {float:right; font-size:28px; cursor:pointer;}
input, select {width:100%; padding:8px; margin:6px 0; border-radius:5px; border:1px solid #333; background:#222; color:#fff;}
</style>

</head>
<body>

<header>
  <div class="logo-container">
    <img src="assets/logo.png" class="logo" alt="Truckinity">
  </div>
  <div class="header-right">
    <div class="language-dropdown" onclick="toggleLangMenu()">
      üåç <span id="currentLanguage">Deutsch</span>
      <div class="lang-menu" id="langMenu">
        <div onclick="setLanguage('de')">üá©üá™ Deutsch</div>
        <div onclick="setLanguage('en')">üá¨üáß English</div>
        <div onclick="setLanguage('ru')">üá∑üá∫ –†—É—Å—Å–∫–∏–π</div>
      </div>
    </div>
    <button id="loginBtn">Login</button>
  </div>
</header>

<!-- Tabs -->
<div class="tabs">
  <button class="tab-btn active" data-tab="parkings">Parkpl√§tze</button>
  <button class="tab-btn" data-tab="restaurants">Rastst√§tten</button>
  <button class="tab-btn" data-tab="favorites">Favoriten</button>
  <button class="tab-btn" data-tab="route">Routen-Check</button>
  <button class="tab-btn" data-tab="sos">Notfall</button>
  <button class="tab-btn" data-tab="fuel">Tankstellen</button>
  <button class="tab-btn" data-tab="weather">Wetter</button>
</div>

<div class="tab-content" id="parkings">
  <button onclick="showAddParking()">Parkplatz hinzuf√ºgen</button>
  <div id="map"></div>
</div>

<div class="tab-content" id="restaurants" style="display:none;">
  <div id="mapRestaurants" style="height:500px; border-radius:10px;"></div>
</div>

<div class="tab-content" id="favorites" style="display:none;">
  <ul id="favoritesList"></ul>
</div>

<div class="tab-content" id="route" style="display:none;">
  <p>Routen-Check / ETA-Planung kommt hier.</p>
</div>

<div class="tab-content" id="sos" style="display:none;">
  <button onclick="sendSOS()">SOS senden</button>
</div>

<div class="tab-content" id="fuel" style="display:none;">
  <p>Tankstellen & Dieselpreise werden hier angezeigt.</p>
</div>

<div class="tab-content" id="weather" style="display:none;">
  <p>Wetter & Stra√üenwarnungen werden hier angezeigt.</p>
</div>

<!-- ===== Add Parking Modal ===== -->
<div id="addParkingModal" class="modal">
  <div class="modal-content">
    <span class="close-btn" onclick="closeAddParking()">&times;</span>
    <h3>Parkplatz hinzuf√ºgen</h3>
    <form id="addParkingForm">
      <input type="text" id="parkingName" placeholder="Name des Parkplatzes" required>
      <select id="parkingFeatures" multiple>
        <option value="dusche">Dusche</option>
        <option value="strom">Strom</option>
        <option value="wifi">WLAN</option>
        <option value="beleuchtet">Beleuchtet</option>
      </select>
      <button type="submit">Hinzuf√ºgen</button>
    </form>
  </div>
</div>

<!-- Firebase + Google Maps + Scripts -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut, onAuthStateChanged } 
from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";
import { getFirestore, collection, addDoc, getDocs } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyD2RHKOn6gaQmQ-AqJTvD2E5vsLp9z54h0",
  authDomain: "truckinity.firebaseapp.com",
  projectId: "truckinity",
  storageBucket: "truckinity.firebasestorage.app",
  messagingSenderId: "150787942012",
  appId: "1:150787942012:web:47214cfb6f3fb1c66c0bf9",
  measurementId: "G-P2S4B6N6PR"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

const loginBtn = document.getElementById("loginBtn");
let isLogin = true; // Modal Login/Register Steuerung

// ===== LOGIN =====
loginBtn.onclick = () => {
  if(auth.currentUser){
    signOut(auth).then(()=>{loginBtn.textContent="Login"; alert("Erfolgreich ausgeloggt")});
  } else {
    const email = prompt("Email:");
    const password = prompt("Passwort:");
    signInWithEmailAndPassword(auth,email,password)
      .then(()=>{loginBtn.textContent="Logout"; alert("Erfolgreich eingeloggt!")})
      .catch(err=>alert(err.message));
  }
};

onAuthStateChanged(auth,(user)=>{
  if(user){loginBtn.textContent="Logout";}
  else{loginBtn.textContent="Login";}
});

// ===== Tabs =====
const tabs = document.querySelectorAll(".tab-btn");
tabs.forEach(btn=>btn.addEventListener("click",()=>{
  document.querySelectorAll(".tab-content").forEach(c=>c.style.display="none");
  document.querySelectorAll(".tab-btn").forEach(b=>b.classList.remove("active"));
  document.getElementById(btn.dataset.tab).style.display="block";
  btn.classList.add("active");
}));

// ===== Language Dropdown =====
function toggleLangMenu(){document.getElementById("langMenu").style.display=document.getElementById("langMenu").style.display==="block"?"none":"block";}
function setLanguage(lang){document.getElementById("currentLanguage").textContent=(lang==="de"?"Deutsch":lang==="en"?"English":"–†—É—Å—Å–∫–∏–π"); alert("Sprache gewechselt: "+lang);}

// ===== Parking Modal =====
function showAddParking(){document.getElementById("addParkingModal").style.display="block";}
function closeAddParking(){document.getElementById("addParkingModal").style.display="none";}

// ===== Add Parking Submission =====
const addParkingForm = document.getElementById("addParkingForm");
addParkingForm.addEventListener("submit", async (e)=>{
  e.preventDefault();
  const name = document.getElementById("parkingName").value;
  const features = Array.from(document.getElementById("parkingFeatures").selectedOptions).map(o=>o.value);
  let lat=0, lng=0;
  if(navigator.geolocation){navigator.geolocation.getCurrentPosition(pos=>{lat=pos.coords.latitude; lng=pos.coords.longitude; addParkingToDB(name,features,lat,lng);});}
});

async function addParkingToDB(name,features,lat,lng){
  try{
    await addDoc(collection(db,"parkings"),{name,features,lat,lng,userId:auth.currentUser.uid,timestamp:Date.now()});
    alert("Parkplatz hinzugef√ºgt!");
    closeAddParking();
  } catch(e){alert("Fehler: "+e.message);}
}

// ===== Map Placeholder (hier Google Maps oder Leaflet einf√ºgen) =====
document.getElementById("map").innerHTML="<p style='text-align:center;padding:200px;color:#888;'>Kartenintegration kommt hier.</p>";
document.getElementById("mapRestaurants").innerHTML="<p style='text-align:center;padding:200px;color:#888;'>Kartenintegration f√ºr Rastst√§tten kommt hier.</p>";

function sendSOS(){alert("SOS gesendet! (Demo)");}

</script>

</body>
</html>
